<!DOCTYPE html>
<html>
<head>
  <title>VocalEyes</title>
  <link rel="stylesheet" href="style.css">
  <script src="jquery.min.js"></script>
  <script>
    $(document).ready(function() {
      // vars

      var wordBuilder = "";
      var sentenceBuilder = "";
      var sentenceLog = [];

      var appendWordToSentenceBuilder = function() {
        sentenceBuilder += wordBuilder + " ";
        wordBuilder = "";
      }

      var appendPunctToSentenceBuilder = function(punct) {
          // change to eliminate all trailing whitespace
      }

      var alpha = {};

      var aNode = {
        'values':['a','b','c','d','back'],
        'a':'a',
        'b':'b',
        'c':'c',
        'd':'d',
        'back':alpha
      }

      var eNode = {
        'values':['e','f','g','h','back'],
        'e':'e',
        'f':'f',
        'g':'g',
        'h':'h',
        'back':alpha
      }

      var iNode = {
        'values':['i','j','k','l','m','n','back'],
        'i':'i',
        'j':'j',
        'k':'k',
        'l':'l',
        'm':'m',
        'n':'n',
        'back':alpha
      }

      var oNode = {
        'values':['o','p','q','r','s','t','back'],
        'o':'o',
        'p':'p',
        'q':'q',
        'r':'r',
        's':'s',
        't':'t',
        'back':alpha
      }

      var uNode = {
        'values':['u','v','w','x','y','z','back'],
        'u':'u',
        'v':'v',
        'w':'w',
        'x':'x',
        'y':'y',
        'z':'z',
        'back':alpha
      }

      var punctNode = {
        'values':['.',',','?','!','back'],
        '.':'.',
        ',':',',
        '?':'?',
        '!':'!',
        'back':alpha
      }

      var functNode = {
        'values':['say','send','back'],
        'say':false,
        'send':false,
        'back':alpha
      }

      alpha['values'] = ['a','e','i','o','u','_','!','<'];
        alpha['a'] = aNode;
        alpha['e'] = eNode;
        alpha['i'] = iNode; 
        alpha['o'] = oNode;
        alpha['u'] = uNode;
        alpha['_'] = appendWordToSentenceBuilder;
        alpha['!'] = punctNode;
        alpha['<'] = functNode;
      

      var currNode = alpha;
      var valueCounter = 0;

      var inputEvent = function() {
        console.log("input detected!");
        var currValue = currNode["values"][valueCounter];
        var valueSelected = currNode[currValue];
        switch(typeof valueSelected)
        {
          case "string":
            wordBuilder += valueSelected;
            currNode = alpha;
            console.log(wordBuilder);
            break;

          case "object":
            currNode = valueSelected;
            console.log(valueSelected)
            break;

          case "function":
            valueSelected();
            break;

          default:
            console.log("something went terribly wrong!");
        }
        
        valueCounter = 0;
        updateInterface();
      };

      // listeners
      $('body').keypress(function(e) {
        if(e.which == 32) { // space
          inputEvent();
        }
      });

      var updateInterface = function() {
        var userInterfaceContents = "";
        for (var i = currNode["values"].length - 1; i >= 0; i--) {
        userInterfaceContents = "<td>" + currNode["values"][i] + "</td>" + userInterfaceContents;
        };
        $("#interface").html("<tr>" + userInterfaceContents + "</tr>");
        $("#interface tr:first td:nth-child(" + (valueCounter + 1) + ")").css({"font-size": "40px", "background": "green", "color": "white", "text-shadow": "0px 0px 0px #000"});

        // update word builder
        $("#word-builder").html(wordBuilder);

        // update sentence builder
        $("#sentence-builder").html(sentenceBuilder);
      };

      setInterval(function() {
        valueCounter = (valueCounter + 1) % currNode["values"].length;

        updateInterface();

        console.log(currNode["values"]);
        console.log(valueCounter);
      }, 1000);   
    });
  </script>
</head>
<body>
<div class="container">
  <h1>VocalEyes</h1>

  <hr>
  <h3>Interface 0.2</h3>
  <ol>
    <li>Use the spacebar to select a group of characters.</li>
    <li>Select _ to add the word in the Word Builder to the Sentence Builder.</li>
    <li>The Sentence Builder inserts spaces between words.</li>
  </ol>
  <table id="interface">
  </table>

  <hr>
  <h3>Word Builder</h3> 
  <p id="word-builder"></p>

  <hr>
  <h3>Sentence Builder</h3>
  <p id="sentence-builder"></p>

  <hr>
  <h3>Sentence Log</h3>
  <table id="sentence-log"></table>

  <footer><small>an apiarygroup project</small></footer>
</div>

</body>
</html>